(()=>{!function(){let t=e();t?function(t){console.log("Loading:",t);try{document.querySelector(".biblePlansHolder").remove()}catch(t){}let l=new FormData;l.append("id",t),document.addEventListener("DOMContentLoaded",(()=>o())),fetch("api/biblePlans/get-bible-plan",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(l)}).then((t=>t.json())).then((t=>{console.log(t),t.status&&(!async function(t){let o,l,{_id:a,books:i,description:u,icon:p,title:m}=t,{booksCount:y,chaptersCount:b}=h(t);try{let t=n();o=t.bookID,l=t.chapterID}catch(t){let e=function(t){console.log("Reroute:",t);let e=t[0].book,n=t[0].chapters[0].number;return{bookID:e,chapterID:n}}(i);o=e.bookID,l=e.chapterID,d(a,o,l)}await c(o,l);let f=document.createElement("div");f.id="biblePlanWindow",f.innerHTML=`\n    <div class="biblePlanSidebar">\n\t\n        <div id="desktopToolbar" class="toolbar">\n            <button class="tableOfContentsBtn"><i class="fa-solid fa-list"></i></button>\n            <button class="annotationsBtn"><i class="fa-regular fa-note-sticky"></i></button>\n            <button class="commentsBtn"><i class="fa-regular fa-comment"></i></button>\n            <button class="translationsBtn"><i class="fa-solid fa-language"></i></button>\n        </div>\n        <div id="sidebar" style="overflow: auto;">\n            <div id="tableOfContents" style="flex-direction: column; display: flex;">\n                <h1 style="margin-bottom:0px;text-align: center; font-family: 'Noto Serif';font-size: 2vw;color: #333;">Table of Contents</h1>\n\t\t\t\t<label style="text-align: center; margin-bottom: 10px; font-family: 'Noto Serif';width: 70%;margin-inline: auto;font-size: 1.5vw;color: #333;">Find chapters and track your completion here!</label>\n            </div>\n            <div id="annotations" style="display: none; flex-direction: column;">\n\t\t\t\t<h1 style="margin-bottom:0px; text-align: center; font-family: 'Noto Serif';">Annotations</h1>\n\t\t\t\t<label style="text-align: center; margin-bottom: 15px; font-family: 'Noto Serif';">Create private notes to study the bible!</label>\n\t\t\t\t<div id="annotationsHolder" style="display: flex; flex-direction: column;">\n\t\t\t\t<div id="annotationsSpinner" style="background-color: white; width: 100%; height: 100%; display: none; justify-content: center; align-items: center; z-index: 100;">\n\t\t\t\t\t<l-ring\n\t\t\t\t\tsize="40"\n\t\t\t\t\tstroke="5"\n\t\t\t\t\tbg-opacity="0"\n\t\t\t\t\tspeed="2"\n\t\t\t\t\tcolor="black" \n\t\t\t\t\t></l-ring>\n\t\t\t\t</div></div>\n\t\t\t\t<div id="annotationsUserInput" style="position: absolute;bottom: 0; flex-direction: column; display: none; width:100%; background-color: #fff;">\n\t\t\t\t\t<label id="annotateRoute"></label>\n\t\t\t\t\t<textarea placeholder="Write down something important to you..." id="annotateBox"></textarea>\n\t\t\t\t\t<button class="biblePlanReadBtn" id="submitAnnotationBtn">Annotate</button>\n\t\t\t\t</div>\n\t\t\t\t<h3 id="annotatePrerequisite">Highlight text to create an annotation!</h3>\n            </div>\n            <div id="comments" style="display: none; flex-direction: column;">\n\t\t\t\t<h1 style="margin-bottom:0px;text-align: center; font-family: 'Noto Serif';">Comments</h1>\n\t\t\t\t<label style="text-align: center; margin-bottom: 10px; font-family: 'Noto Serif';">Chat with other STC members about this chapter!</label>\n\t\t\t\t<div id="commentsHolder" style="display: flex; flex-direction: column;">\n\t\t\t\t\t<div id="commentsSpinner" style="background-color: white; width: 100%; height: 100%; display: none; justify-content: center; align-items: center; z-index: 100;">\n\t\t\t\t\t\t<l-ring\n\t\t\t\t\t\tsize="40"\n\t\t\t\t\t\tstroke="5"\n\t\t\t\t\t\tbg-opacity="0"\n\t\t\t\t\t\tspeed="2"\n\t\t\t\t\t\tcolor="black" \n\t\t\t\t\t\t></l-ring>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div id="commentUserInput" style="position: absolute;bottom: 0; flex-direction: column; display: none; width:100%; background-color: #fff;">\n\t\t\t\t\t<label id="quote">Quoting: </label>\n\t\t\t\t\t<textarea placeholder="Speak your mind..."id="commentBox" style="width: calc(95% - 10px); resize: none; font-family: 'roboto'; border: solid 1px #ccc; height: 20vh; padding: 10px;"></textarea>\n\t\t\t\t\t<button id="submitCommentBtn" class="biblePlanReadBtn" style="width=95%;">Comment</button>\n\t\t\t\t</div>\n\t\t\t\t<h3 id="commentPrerequisite" style="position: absolute;bottom: 0; display: none;">Highlight text to create a comment!</h3>\n            </div>\n            <div id="translations" style="display:none; flex-direction: column;">\n\t\t\t\t<h1 style="margin-bottom:0px; text-align: center; font-family: 'Noto Serif';">Translations</h1>\n\t\t\t\t<label style="text-align:center; margin-bottom: 5px; font-family: 'Noto Serif';" for="languageDropdown">Your Language:</label>\n\t\t\t\t<select class="signupInput" style="text-indent: 0px; border-radius: 12px; width: 92.5%;" id="languageDropdown"></select>\n\t\t\t\t<label style="text-align:center; margin-top: 20px; font-family: 'Noto Serif';" id="currentTranslation">Current Translation: </label>\n\t\t\t\t<div id="translationsHolder" style="display:flex; flex-direction: column;"></div>\n            </div>\n        </div>\n    </div>\n    <div class="biblePlanReadPage">\n\t\t<div id="mobileToolbar" class="toolbar">\n            <button class="tableOfContentsBtn"><i class="fa-solid fa-list"></i></button>\n            <button class="annotationsBtn"><i class="fa-regular fa-note-sticky"></i></button>\n            <button class="commentsBtn"><i class="fa-regular fa-comment"></i></button>\n            <button class="translationsBtn"><i class="fa-solid fa-language"></i></button>\n\t\t\t<button style="display: none; color: #f75252;" class="closeBtn"><i class="fa-regular fa-circle-xmark"></i></button>\n        </div>\n        <h1 style="color: #333; font-family: 'Noto Serif'; font-size: 40px; text-align: center; margin-block: 0px; margin-top: 10px;">${m}</h1>\n        <h2 id="chapterTitle" style="color: #333; font-weight: 400; font-family: 'Noto Serif'; font-size: 30px; text-align: center; margin-block: 10px;"></h2>\n        <div class="biblePlanPages">\n\t\t\t<div class="biblePlanPopup" id="biblePlanPopup"><button class="filterBtn" id="annotateBtn"><i class="fa-regular fa-note-sticky"></i> Annotate</button><button class="filterBtn" id="commentBtn"><i class="fa-regular fa-comment"></i> Comment</button></div>\n            <div class="biblePlanPage" id="page1"></div>\n        </div>\n        <div class="pageSwitch">\n            <button id="pageBackward"><i class="fa-solid fa-arrow-left"></i></button>\n            <p id="pageNumber">1</p>\n            <button id="pageForward"><i class="fa-solid fa-arrow-right"></i></button>\n        </div>\n    </div>\n\t<style>\n\n\t\t#commentProfile {\n\t\t\ttext-decoration: none;\n\t\t\tcursor: pointer;\n\t\t}\n\n\t\t#commentProfile > p {\n\t\t\tfont-weight: bold;\n\t\t\tcolor: #333;\n\t\t}\n\n\t\t#commentProfile > img {\n\t\t\twidth: 45px;\n\t\t\theight: 45px;\n\t\t\tmargin-left: 0px;\n\t\t}\n\n\t\t.deleteBtn {\n\t\t\tborder: solid 1px #ccc;\n\t\t\tborder-radius: 12px;\n\t\t}\n        .deleteBtn:hover {\n            background-color: #f75252 !important;\n\t\t\tborder: solid 1px #fff0;\n        }\n    </style>\n    `,f.querySelector("#pageForward").addEventListener("click",r),f.querySelector("#pageBackward").addEventListener("click",s),f.querySelector("#languageDropdown").addEventListener("change",L),f.querySelector("#commentBtn").addEventListener("click",C),f.querySelector("#annotateBtn").addEventListener("click",P),f.querySelector("#submitCommentBtn").addEventListener("click",H),f.querySelector("#submitAnnotationBtn").addEventListener("click",R),document.querySelector("body").appendChild(f),function(t,n){let o;fetch("https://bolls.life/get-books/ESV/",{method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((t=>t.json())).then((l=>{o=l,t.forEach((t=>{let n=t.chapters.length,l=parseInt(t.book)-1,a=o[l].name,i=document.createElement("div");i.innerHTML=`\n                <div class="bookChapterList" id="book${l}">\n\t\t\t\t\t<div class="inlineBookTitle">\n\t\t\t\t\t\t<h3 style="font-size: 1.30vw;margin-block: auto;color: #333;" id=${l}>${a} (0/${n})</h3>\n\t\t\t\t\t\t<button style="position: static;border: none;margin: 0px; margin-left: auto;margin-block: auto;" class="bookTitleDropBtn" id="bookDropBtn"><i class="fa-solid fa-chevron-right"></i></button>\n\t\t\t\t\t</div>\n                        \n\t\t\t\t\t<div id="chapters">\n\t\t\t\t\t\t\n\t\t\t\t\t</div>\n                </div>`,t.chapters.forEach((t=>{let n=t.number,o=document.createElement("a");o.id=`${l}:${n}`,o.innerHTML=`Chapter ${n}`,o.className="biblePlanChapter";let a=e();o.href=`/biblePlans?id=${a}&b=${l+1}&c=${n}`,i.querySelector("#chapters").appendChild(o)})),document.querySelector("#tableOfContents").appendChild(i)})),function(t,e){let n=document.getElementById(t),o=document.getElementById("sidebar");if(o&&n){const t=n.offsetTop;o.scrollTo({top:t-o.offsetTop,behavior:e})}}("book"+(n-1),"smooth"),function(t){let e=document.getElementById("book"+(t-1)),n=e.querySelector("#bookDropBtn");const o=e.closest(".bookChapterList");if(o){const t=o.querySelector("#chapters");if(t){const e=o.parentElement;"flex"===t.style.display?(n.querySelector("i").style.transform="rotate(0deg)",t.style.display="none",e.style.marginBottom="0vw"):(n.querySelector("i").style.transform="rotate(90deg)",t.style.display="flex",e.style.marginBottom="2vw")}}}(n)}))}(i,o),fetch("https://bolls.life/static/bolls/app/views/languages.json",{method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((t=>t.json())).then((t=>{!function(t){let e=[],n=document.createElement("div");n.id="languageHolder",t.forEach((t=>{let o=t.language;e.push(o);let l=t.translations,a=document.createElement("div");a.style.display="none",a.id=o,a.style.flexDirection="column",l.forEach((t=>{let e=document.createElement("div");e.className="bibleTranslation",e.id=t.short_name,e.innerHTML=`\n\t\t\t<div style="display: flex; flex-direction: column; width: 85%;">\n\t\t\t\t\t<h2>${t.short_name}</h2>\n\t\t\t\t\t<h3>${t.full_name}</h3>\n\t\t\t\t</div>\n\t\t\t\t<button id="selectTranslationBtn"></button>\n\t\t\t`,e.querySelector("#selectTranslationBtn").addEventListener("click",D),a.appendChild(e)})),n.appendChild(a)})),e.forEach((t=>{const e=document.createElement("option");e.value=t,e.text=t,document.querySelector("#languageDropdown").appendChild(e)})),document.querySelector("#languageDropdown").value=T(),document.querySelector("#translationsHolder").appendChild(n),I(T()),$()}(t)}))}(t.biblePlan),localStorage.setItem("biblePlan",JSON.stringify(t.biblePlan.books)))}))}(t):(console.log("Loading Main"),fetch("api/biblePlans/get-bible-plans",{method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((t=>t.json())).then((t=>{var e;t.status&&(t.biblePlans.forEach((t=>{!function(t){let{_id:e,books:n,description:o,icon:l,title:a}=t,{booksCount:i,chaptersCount:r}=h(t),s=document.createElement("div"),c="https://upload.wikimedia.org/wikipedia/commons/thumb/1/17/Christ_at_the_Cross_-_Cristo_en_la_Cruz.jpg/640px-Christ_at_the_Cross_-_Cristo_en_la_Cruz.jpg";l.name&&(c="/image/"+l.name),s.className="biblePlan",s.id=e,s.style="width: 100%;",s.innerHTML=`\n                <div class="biblePlanImage" style="width: 45%;">\n                    <img style="width: 100%; height: 100%; border-radius: 10px 0px 0px 10px; object-fit: fill;" src="${c}" alt="">\n                </div>\n                <div class="biblePlanInformation" style="padding-left: 20px; width: 55%; position: relative;">\n                    <h3 class="biblePlanHeader">${a}</h3>\n                    <p class="biblePlanDescriptor">${o}</p>\n                    <p class="biblePlanDescriptor">${i} books, ${r} chapters</p>\n\t\t\t\t\t<label class="biblePlanDescriptor" for="${r}" id="progressCounter">0% completed</label>\n                    <div class="biblePlanProg">\n                        <span style="width: 0%"id="${r}" class="innerBiblePlanProg"></span>\n                    </div>\n                    <a class="biblePlanBtn" href="/biblePlans?id=${e}">Continue</a>\n                </div>`,document.querySelector(".biblePlans").appendChild(s)}(t),function(t){console.log(t);let e=document.createElement("div");e.className="tableContentsPlan",e.id=t._id;let n=u[t.books[0].book],o=t.books[0].chapters[0].number;e.innerHTML=`\n                <div class="tableContentsIcon" style="margin-inline: 7px;">\n                    <i class="fa-solid fa-book"></i>\n                </div>\n                <div class="display: flex; flex-direction: column; padding-top: 2px;">\n                    <h3 style="margin-block: 0px; margin-inline: 5px;">${t.title}</h3>\n                    <p id="resumeText"style="margin-block: 0px; margin-inline: 5px; color: #6f6f6f;">${n} ${o}</p>\n                </div>\n            \t`,e.addEventListener("click",b),document.querySelector(".tableContents").appendChild(e)}(t)})),document.querySelector(".tableContents").style.display="block",document.querySelector(".biblePlans").style.display="flex",e=t.userPlans,console.log(e),e.forEach((t=>{let e=document.getElementById(t.id),n=e.querySelector(".innerBiblePlanProg"),o=t.chaptersFinished.length/n.id;e.querySelector("#progressCounter").innerHTML=`${(100*o).toFixed(0)}% completed`,n.style.width=100*o+"%"})),function(t,e){let n=[];console.log("Your Plans:",t),console.log("DB Plans:",e),t.forEach((t=>{n.push({id:t.id,verse:t.chaptersFinished[t.chaptersFinished.length-1]})})),e.forEach((t=>{let e=n.filter((e=>e.id==t._id));console.log("Filter:",e),0===e.length&&n.push({id:t._id})})),console.log("Result:",n),n.length>0&&n.forEach((t=>{let e=CSS.escape(t.id),n=document.querySelector(".tableContents").querySelector("#"+e).querySelector("#resumeText");if(t.verse){let e=t.verse.split(":")[0],o=t.verse.split(":")[1];n.innerHTML=`${u(e)} ${o}`}else n.innerHTML="Start"}))}(t.userPlans,t.biblePlans))})))}();const t=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");function e(){let t=window.location.search.split("?")[1];return t?t.split("&")[0].split("=")[1]:null}function n(){try{let t=window.location.search.split("?")[1];if(!t)return null;let e=t.split("&");return{bookID:e[1].split("=")[1],chapterID:e[2].split("=")[1]}}catch(t){return null}}function o(){document.querySelector("#spinner").style.display="flex";try{document.querySelector("#biblePlanWindow").style.display="none"}catch(t){}}function l(t){document.getElementById(t).style.display="flex"}function a(t){document.getElementById(t).style.display="none"}function i(t,e){let n=!1;return JSON.parse(localStorage.getItem("biblePlan")).forEach((o=>{t==parseInt(o.book)&&o.chapters.forEach((t=>{e==t.number&&(n=!0)}))})),n}function r(){let{bookID:t,chapterID:e}=n(),o=B();fetch(`https://bolls.life/get-books/${o}/`,{method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((t=>t.json())).then((n=>{let o=n[t-1].chapters;e==o&&t<65?i(parseInt(t)+1,1)&&c(parseInt(t)+1,1):i(t,parseInt(e)+1)&&c(t,parseInt(e)+1)}))}function s(){let{bookID:t,chapterID:e}=n();1==e&&t>1?i(parseInt(t)-1,1)&&c(parseInt(t)-1,1):e>=2&&i(t,parseInt(e)-1)&&c(t,parseInt(e)-1)}async function c(t,l){!function(t,e){fetch("https://bolls.life/get-books/ESV/",{method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((t=>t.json())).then((n=>{let o=`${n[t-1].name} | Chapter ${e}`;document.querySelector("#chapterTitle").innerHTML=o,document.title=`${o} | Long X Ranch Cowboys`}))}(t,l),d(e(),t,l),o();let a=B();fetch(`https://bolls.life/get-chapter/${a}/${t}/${l}/`,{method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((t=>t.json())).then((t=>{document.querySelector("#pageNumber").innerHTML=l,function(t){localStorage.setItem("chapter",JSON.stringify(t));let e=document.querySelector("#page1");e.innerHTML="",t.forEach((t=>{let{verse:n,text:o}=t;o=function(t){return t.includes("<S>")||t.includes("<sup>")?t=(t=t.replaceAll(/<S>.*?<\/S>/g,"")).replaceAll(/<sup>.*?<\/sup>/g,""):t}(o),e.innerHTML+=`<sup id="${n}" style="font-size: .7em; font-weight: bold;">${n}</sup> <span id="${n}">${o}</span>   `})),N()}(t),document.querySelector("#biblePlanWindow").style.display="flex",document.querySelector("#spinner").style.display="none",function(){let t=new FormData,o=e(),{bookID:l,chapterID:a}=n();t.append("id",o),t.append("bookID",l),t.append("chapterID",a),fetch("api/biblePlans/check-plan-completion",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(t)}).then((t=>t.json())).then((t=>{t.status&&(function(t){for(let e=0;e<Object.keys(t).length;e++){let n=parseInt(Object.keys(t)[e])-1,o=Object.values(t)[e],l=document.querySelector("#tableOfContents").querySelector(`[id='${n}']`),a=`${l.innerHTML.split("(")[0]}(${o}/${l.innerHTML.split("/")[1]}`;l.innerHTML=a}}(t.completion),function(){let t=new FormData,n=e();t.append("id",n),fetch("api/biblePlans/get-completed-chapters",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(t)}).then((t=>t.json())).then((t=>{t.status&&t.chaptersFinished.forEach((t=>{let e=t.split(":"),n=`${parseInt(e[0])-1}:${e[1]}`,o=document.getElementById(n);o.innerHTML.includes('<i class="fa-solid fa-square-check"></i>')||(o.innerHTML='<i class="fa-solid fa-square-check"></i> '+o.innerHTML,o.style="background-color: #3dd598; color: #fff; border-radius: 8px;")}))})),document.addEventListener("DOMContentLoaded",(()=>{}))}())}))}()}))}function d(t,e,n){const o=new URL(window.location.href),l=new URLSearchParams;l.set("id",t),l.set("b",e),l.set("c",n);const a=`${o.pathname}?${l.toString()}`;window.history.replaceState({},"",a)}function u(t){return p[t-1]}const p=["Genesis","Exodus","Leviticus","Numbers","Deuteronomy","Joshua","Judges","Ruth","1 Samuel","2 Samuel","1 Kings","2 Kings","1 Chronicles","2 Chronicles","Ezra","Nehemiah","Esther","Job","Psalms","Proverbs","Ecclesiastes","Song of Solomon","Isaiah","Jeremiah","Lamentations","Ezekiel","Daniel","Hosea","Joel","Amos","Obadiah","Jonah","Micah","Nahum","Habakkuk","Zephaniah","Haggai","Zechariah","Malachi","Matthew","Mark","Luke","John","Acts","Romans","1 Corinthians","2 Corinthians","Galatians","Ephesians","Philippians","Colossians","1 Thessalonians","2 Thessalonians","1 Timothy","2 Timothy","Titus","Philemon","Hebrews","James","1 Peter","2 Peter","1 John","2 John","3 John","Jude","Revelation"];function m(){let t=event.target.closest("div").querySelector("#location").innerHTML,n=t.split(" ")[0],o=t.split(" ")[1],l=o.split(":")[0],a=(o.split(":")[1],p.indexOf(n)+1),i=e();window.location.assign(`/biblePlans?id=${i}&b=${a}&c=${l}`)}function y(){}function b(){let t=event.target.closest(".tableContentsPlan").id,e=p.indexOf(event.target.closest(".tableContentsPlan").querySelector("#resumeText").innerHTML.split(" ")[0])+1,n=event.target.closest(".tableContentsPlan").querySelector("#resumeText").innerHTML.split(" ")[1];if(null==e||null==e||null==n||null==n)return window.location.assign(`/biblePlans?id=${t}`);window.location.assign(`/biblePlans?id=${t}&b=${e}&c=${n}`)}function h(t){let e=0,n=0;return t.books.forEach((t=>{e++,n+=t.chapters.length})),{booksCount:e,chaptersCount:n}}function f(t){document.querySelector("#tableOfContents").style.display="none",document.querySelector("#annotations").style.display="none",document.querySelector("#comments").style.display="none",document.querySelector("#translations").style.display="none",document.querySelector(`#${t}`).style.display="flex"}function g(t){try{let e=window.getSelection(),n=e.anchorNode,o=e.focusNode;if("page1"!=n.parentElement.parentElement.id||"page1"!=o.parentElement.parentElement.id)return;const l=e.toString().trim(),a=document.getElementById("biblePlanPopup");if(l.length>0){const e=window.getSelection().getRangeAt(0).getBoundingClientRect();a.style.left=`${e.left+window.scrollX}px`,a.style.top=`${e.bottom+window.scrollY+t}px`,a.style.display="block"}else a.style.display="none"}catch(t){}}function S(){let t=document.querySelector("#chapterTitle").innerHTML.split(" |")[0],{chapterID:e}=n();return{bookName:t,chapterID:e}}function v(){document.querySelector("#commentUserInput").style.display="none",document.querySelector("#commentPrerequisite").style.display="flex"}function w(t,e,n){let{startVerse:o,endVerse:l}=function(t){let e=t.anchorNode,n=t.focusNode,o=parseInt(e.parentElement.id),l=parseInt(n.parentElement.id);return o<l?{startVerse:o,endVerse:l}:l<o?{startVerse:l,endVerse:o}:{startVerse:o,endVerse:o}}(n),a=`${t} ${e}:${o}`;return o!=l&&(a+=`-${l}`),a}function x(){let t=window.getSelection(),{bookName:e,chapterID:n}=S(),o=w(e,n,t);t.toString().trim()?document.querySelector("#quote").innerHTML=`Quoting: ${o}`:v()}function q(){f("translations"),document.querySelector(".biblePlanSidebar").style.display="flex",document.querySelector(".closeBtn").style.display="block"}function k(){window.getSelection().anchorNode?(C(),x()):(v(),f("comments"),document.querySelector(".biblePlanSidebar").style.display="flex",document.querySelector(".closeBtn").style.display="block")}function P(){f("annotations"),document.querySelector(".biblePlanSidebar").style.display="flex",document.querySelector(".closeBtn").style.display="block",_();let t=window.getSelection();if(t.toString().trim()){let{bookName:e,chapterID:n}=S();document.querySelector("#annotationsUserInput").style.display="flex",document.querySelector("#annotatePrerequisite").style.display="none",document.querySelector("#annotateRoute").innerHTML=w(e,n,t)}else document.querySelector("#annotationsUserInput").style.display="none",document.querySelector("#annotatePrerequisite").style.display="flex"}function C(){document.querySelector("#commentPrerequisite").style.display="none",document.querySelector("#commentUserInput").style.display="flex",f("comments"),document.querySelector(".biblePlanSidebar").style.display="flex",document.querySelector(".closeBtn").style.display="block"}function E(){f("tableOfContents"),document.querySelector(".biblePlanSidebar").style.display="flex",document.querySelector(".closeBtn").style.display="block"}function I(t){document.querySelector("#languageHolder").childNodes.forEach((e=>{e.id!=t?e.style.display="none":e.style.display="flex"}))}function T(){let t=localStorage.getItem("language");return t||(localStorage.setItem("language","English"),T())}function L(){let t=document.querySelector("#languageDropdown").value;localStorage.setItem("language",t),I(t)}function B(){let t=localStorage.getItem("translation");return t||(localStorage.setItem("translation","ESV"),B())}function D(){!async function(t){localStorage.setItem("translation",t),$();let{bookID:e,chapterID:o}=n();await c(e,o)}(event.target.closest("div").id)}function $(){let t=B();document.querySelector("#currentTranslation").innerHTML=`Current Translation: ${t}`,document.querySelectorAll("#selectTranslationBtn").forEach((t=>{t.innerHTML="",t.parentElement.style.backgroundColor="white"})),document.querySelector(`#${t}`).style.backgroundColor="#d5d5d5",document.querySelector(`#${t}`).querySelector("#selectTranslationBtn").innerHTML='<i class="fa-solid fa-check"></i>'}function H(){let t=e(),{bookID:o,chapterID:l}=n(),a=document.querySelector("#commentBox").value,i=document.querySelector("#quote").innerHTML.split(": ")[1],r=new FormData;r.append("id",t),r.append("bookID",o),r.append("chapterID",l),r.append("comment",a),r.append("location",i),fetch("api/biblePlans/create-comment",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(r)}).then((t=>t.json())).then((t=>{console.log(t),document.querySelector("#commentPrerequisite").style.display="flex",document.querySelector("#commentUserInput").style.display="none",document.querySelector("#commentBox").value="",N()}))}function M(){document.querySelector("#commentsHolder").style.display="none",document.querySelector("#commentsHolder").childNodes.forEach((t=>{"commentsSpinner"!=t.id&&t.remove()})),document.querySelector("#commentsHolder").style.display="flex"}function N(){document.querySelector("#commentsHolder").style.display="none",M(),document.querySelector("#commentsHolder").style.display="flex",l("commentsSpinner"),function(){let{bookName:t,chapterID:e}=S()}();let o=e(),{bookID:i,chapterID:r}=n(),s=new FormData;s.append("id",o),s.append("bookID",i),s.append("chapterID",r),fetch("api/biblePlans/get-comments",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(s)}).then((t=>t.json())).then((e=>{var n;n=e.comments,M(),n.forEach((e=>{let{comment:n,location:o,uID:l,postDate:a}=e,i=document.createElement("div");i.innerHTML=`\n\t\t<div class="annotation">\n\t\t\t<div class="inlineAnnotationTitle"> \n\t\t\t\t<a class="navProfileUser" id="commentProfile" href="/profile?uid=${l}"></a>\n\t\t\t\t<label style="margin-left: auto; color: #797979; font-family: 'Noto Serif'; margin-block: auto;" id="location"for="comment">${o}</label>\n\t\t\t</div>\n\t\t\t<p style="padding-bottom: 15px;" class="annotationText" id="comment">${t(n)}</p>\n\t\t</div>\n\t\t\n\t\t`,document.querySelector("#commentsHolder").appendChild(i);let r=new FormData;r.append("uid",l),fetch("api/profile/load",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(r)}).then((t=>t.json())).then((t=>{if(t.status){let{username:e,pfp:n}=t.profile;i.querySelector("#commentProfile").innerHTML=`<img src="/image/${n}" alt="Profile pic"> <p>${e}</p>`}else t.profile||i.remove()}))})),a("commentsSpinner")}))}function R(){let t=e(),{bookID:o,chapterID:l}=n(),a=document.querySelector("#annotateBox").value,i=document.querySelector("#annotateRoute").innerHTML,r=new FormData;r.append("id",t),r.append("bookID",o),r.append("chapterID",l),r.append("annotation",a),r.append("location",i),fetch("api/biblePlans/create-annotation",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(r)}).then((t=>t.json())).then((t=>{console.log(t),document.querySelector("#annotationsUserInput").style.display="none",document.querySelector("#annotatePrerequisite").style.display="flex",document.querySelector("#annotateBox").value="",document.querySelector("#annotateRoute").innerHTML="",_()}))}function _(){document.querySelector("#annotationsHolder").style.display="none",document.querySelector("#annotationsHolder").childNodes.forEach((t=>{"annotationsSpinner"!=t.id&&t.remove()})),document.querySelector("#annotationsHolder").style.display="flex",l("annotationsSpinner");let o=e(),{bookID:i,chapterID:r}=n(),s=new FormData;s.append("id",o),s.append("bookID",i),s.append("chapterID",r),fetch("api/biblePlans/get-annotations",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(s)}).then((t=>t.json())).then((e=>{e.status&&e.annotations?(e.annotations.forEach((e=>{let{annotation:n,location:o,uID:l,postDate:a}=e,i=document.createElement("div");i.innerHTML=`\n\t\t<div class="annotation">\n\t\t\t<div class="inlineAnnotationTitle"> \n\t\t\t\t<label class="annotationTitle" id="location"for="comment">${o}</label>\n\t\t\t\t<button class="viewVerseBtn" id="viewVerseBtn">View Verse</button>\n\t\t\t</div>\n\t\t\t<p class="annotationText" id="comment">${t(n)}</p>\n\t\t\t<div style="display:flex;flex-direction:row;">\n\t\t\t\t<button style="height: 45px; line-height:0px;" class="btnLink deleteBtn" id="deleteAnnotationBtn"><i class="fa-solid fa-trash"></i> Delete</button>\n\t\t\t\t<button class="annotationDrop"><i class="fa-solid fa-chevron-down"></i></button>\n\t\t\t</div>\n\t\t</div>\n\t\t`,i.querySelector("#deleteAnnotationBtn").addEventListener("click",y),i.querySelector("#viewVerseBtn").addEventListener("click",m),document.querySelector("#annotationsHolder").appendChild(i)})),a("annotationsSpinner")):a("annotationsSpinner")}))}document.addEventListener("mouseup",(()=>g(10))),document.addEventListener("selectionchange",(()=>g(10))),document.addEventListener("mousedown",(function(t){"commentBtn"==t.target.id?(C(),x()):"annotateBtn"==t.target.id&&P();try{document.getElementById("biblePlanPopup").style.display="none"}catch(t){}}));new MutationObserver(((t,e)=>{const n=document.querySelectorAll("#bookDropBtn");n.length>0&&n.forEach((t=>{t.hasAttribute("data-listener-added")||(t.addEventListener("click",(t=>{let e=t.target.closest("button");const n=e.closest(".bookChapterList");if(n){const t=n.querySelector("#chapters");if(t){const o=n.parentElement;"flex"===t.style.display?(e.querySelector("i").style.transform="rotate(0deg)",t.style.display="none",o.style.marginBottom="0vw"):(e.querySelector("i").style.transform="rotate(90deg)",t.style.display="flex",o.style.marginBottom="2vw")}}})),t.setAttribute("data-listener-added","true"))}))})).observe(document.body,{childList:!0,subtree:!0}),document.addEventListener("DOMContentLoaded",(function(){const t=setInterval((()=>{const e=document.querySelectorAll(".tableOfContentsBtn");e.length>0&&(e.forEach((t=>{t.addEventListener("click",E)})),document.querySelectorAll(".commentsBtn").forEach((t=>{t.addEventListener("click",k)})),document.querySelectorAll(".translationsBtn").forEach((t=>{t.addEventListener("click",q)})),document.querySelectorAll(".annotationsBtn").forEach((t=>{t.addEventListener("click",P)})),document.querySelector(".closeBtn").addEventListener("click",(()=>{document.querySelector(".biblePlanSidebar").style.display="none",document.querySelector(".closeBtn").style.display="none"})),clearInterval(t))}),100)}))})();