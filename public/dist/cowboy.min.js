(()=>{let e=[];document.addEventListener("DOMContentLoaded",(()=>{document.querySelector("#storyInput").addEventListener("click",(function(){document.querySelector(".createStory").style="height: calc(60vh - 30px); flex-direction: column;",anime({targets:".createStory",width:["50%","94%"],height:["fit-content","calc(70vh - 55px)"],easing:"easeInOutQuad",duration:1e3}),document.querySelector(".tox").style="display: flex; height: 500px; width: 93%; margin-inline: auto;",document.querySelector("#createStoryTitle").style='display: block; padding: 10px; font-family: "Roboto"; background-color: #fff; width: 90%;',document.querySelector("#createStoryDesc").style='display: block; padding: 10px; font-family: "Roboto"; background-color: #fff; width: 90%;',document.querySelector("#storyInput").style.display="none",document.querySelector(".submitImage").style.display="flex"})),document.querySelector("#postStoryBtn").addEventListener("click",l)})),document.addEventListener("click",(function(e){let t=document.querySelector(".createStory"),o=document.querySelector(".cowboyStoryExplore");if("calc(-55px + 70vh)"==t.style.height&&!t.contains(e.target)){const e=parseFloat(window.getComputedStyle(t).getPropertyValue("width")),n=parseFloat(window.getComputedStyle(o).getPropertyValue("width")),r=window.innerWidth;console.log(e/r),console.log(e/n),e/r!=.9&&window.innerWidth<=856?(anime({targets:".createStory",width:["94%","90%"],height:["calc(70vh - 55px)","7vh"],easing:"easeInOutQuad",duration:1e3}),t.style.flexDirection="row"):e/n!=.5&&window.innerWidth>856&&(anime({targets:".createStory",width:["94%","50%"],height:["calc(70vh - 55px)","7vh"],easing:"easeInOutQuad",duration:1e3}),t.style.flexDirection="row"),document.querySelector(".tox").style.display="none",document.querySelector("#createStoryTitle").style.display="none",document.querySelector("#createStoryDesc").style.display="none",document.querySelector("#storyInput").style="margin-inline: none; width: 100%; margin-block: 1px; border: none; padding-inline: 2px;",document.querySelector(".submitImage").style.display="none"}})),fetch("api/cowboy/get-stories",{method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((e=>e.json())).then((e=>{console.log(e),e.status&&e.cowboyStories.forEach((e=>function(e){let t=document.createElement("div");t.id=e._id,t.className="cowboyStory",t.innerHTML=`\n        <div>\n            <h1>${e.title}</h1>\n            <p>${e.description}</p>\n            <button id="readMore" class="btnLink">Read More</button>\n        </div>\n\t`,e.images.length>=1&&(t.innerHTML=`<img src="${window.location.origin}/image/${e.images[0].name}" alt="">`+t.innerHTML),t.querySelector("#readMore").addEventListener("click",(e=>{let t=e.target.closest(".cowboyStory").id;window.open(`/forum?id=${t}`,"_blank")})),document.querySelector(".featuredStories").appendChild(t)}(e)))}));const t=(e,t)=>{const n=document.querySelector("#"+e);console.log(n),o(n,t)},o=(e,t)=>{e.style.border=`2px solid ${t}`};function n(){console.log("Uploading...");const t=Array.from(event.target.files);e=e.concat(t),console.log(e),t.length>0&&t.forEach((e=>{if(e&&e.type.startsWith("image/")){const t=new FileReader;let o=document.createElement("div");o.innerHTML=`\n\t\t\t\t\t<img id="${e.name}" style="width: 150px; height: 150px; border: 2px solid grey; object-fit: cover;"></img>\n\t\t\t\t\t<button>Delete</button> \n\t\t\t\t`,o.querySelector("button").addEventListener("click",r);let n=o.querySelector("img");t.onload=function(e){n.src=e.target.result,function(e){e.onload=function(){let t=parseFloat(e.style.height.replace("px","")),o=e.naturalHeight,n=(e.naturalWidth/o).toFixed(2);e.style.width=n*t+"px"}}(n)},t.readAsDataURL(e),document.querySelector("#images").appendChild(o)}else alert("Please upload a valid image file.")}))}function r(){let t=event.target.parentElement.querySelector("img").id;event.target.parentElement.remove(),console.log(t),e=e.filter((e=>e.name!==t)),console.log(e)}function l(){let o=document.querySelector("#createStoryTitle").value,n=document.querySelector("#createStoryDesc").value,r=tinymce.get("message").getContent();if(function(e,o,n){console.log(e,o);let r=!1;return""==e&&(t("createStoryTitle","red"),r=!0),""==o&&(t("message_ifr","red"),r=!0),""==n&&(t("createStoryDesc","red"),r=!0),r}(o,r,n))return;let l=new FormData;if(l.append("title",o),l.append("message",r),l.append("description",n),console.log("All Files Uploaded:",e),e.length>0)for(let t=0;t<e.length;t++)l.append("files",e[t]);fetch("api/cowboy/create-story",{method:"post",body:l}).then((e=>e.json())).then((e=>{console.log(e),e.status&&window.location.replace(`/forum?id=${e.id}`)}))}document.addEventListener("DOMContentLoaded",(()=>{document.getElementById("dropArea").addEventListener("dragover",(function(e){e.preventDefault()})),document.getElementById("dropArea").addEventListener("drop",n),document.getElementById("addImage").addEventListener("change",n)})),document.querySelector("#removeImageBtn").addEventListener("click",(function(){document.getElementById("imageUploadPreview").setAttribute("src",""),document.querySelector(".submitImageText").style.display="flex",document.querySelector(".imageUploadPreviewDiv").style.display="none",document.querySelector("#removeImageBtn").style.display="none"}))})();