(()=>{const e=(e,o)=>{const r=document.querySelector("#"+e);t(r,o)},t=(e,t)=>{e.style.border=`2px solid ${t}`},o=(e,t,o)=>{try{document.querySelector(`#${e}Error`).innerHTML=t}catch(r){document.querySelector(`#${e}`).insertAdjacentHTML("afterend",`<p style="color: ${o}; margin-bottom: 0px; font-size: 13pt;" id="${e}Error">${t}</p>`)}},r=e=>{try{document.querySelector(`#${e}Error`).remove()}catch(e){}},n=()=>{let t=document.querySelector("#password").value;return t.length>=8&&/\d/.test(t)&&/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+/.test(t)?(e("password","green"),r("password"),!0):(e("password","red"),o("password","Password must be at least 8 characters long, have a number, and have a capital and lowercase character","red"),!1)};let s;document.querySelector("#sendEmailBtn").addEventListener("click",(function(){let e=document.querySelector("#email").value;console.log(e);const t=new FormData;t.append("email",e),fetch("api/auth/get-reset-code",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(t)}).then((e=>e.json())).then((t=>{console.log(t),t.status?(document.querySelector("#response").innerHTML=`Your verification code has been sent to the email: <b>${e}</b>. \nIt may take a few minutes for you to receive your code. Do <b>NOT</b> click the <a href="/forgot-password">back</a> button to try again for 5 minutes.`,document.querySelector("#getCode").style.display="none",document.querySelector("#verifyCode").style.display="flex",document.querySelector("#email").innerHTML=""):(document.querySelector("#response").innerHTML=`There was an error processing your request. Are you sure there is an account associated with the email: ${e}`,document.querySelector("#getCode").style.display="block",document.querySelector("#verifyCode").style.display="none")}))})),document.querySelector("#hasCodeBtn").addEventListener("click",(function(){document.querySelector("#sendEmailBtn").style.display="none",document.querySelector("#hasCodeBtn").style.display="none",document.querySelector("#verifyCode").style.display="flex"})),document.querySelector("#verifyCodeBtn").addEventListener("click",(function(){let e=document.querySelector("#email").value,t=document.querySelector("#code").value;console.log(t);const o=new FormData;o.append("email",e),o.append("code",t),fetch("api/auth/verify-reset-code",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(o)}).then((e=>e.json())).then((e=>{console.log(e),e.status?(console.log("You may reset your password."),document.querySelector("#codeDiv").style.display="none",document.querySelector("#resetDiv").style.display="block"):console.log("Error.")}))})),document.querySelector("#backBtn").addEventListener("click",(function(){document.querySelector("#sendEmailBtn").style.display="inline",document.querySelector("#hasCodeBtn").style.display="block",document.querySelector("#verifyCode").style.display="none",document.querySelector("#email").innerHTML=""}));document.querySelector("#password").addEventListener("input",(()=>{((e,t)=>{clearTimeout(s),s=setTimeout(e,t)})(n,500)})),document.querySelector("#resetPasswordBtn").addEventListener("click",(function(){let t=document.querySelector("#email").value,n=document.querySelector("#code").value,s=document.querySelector("#password").value;const a=new FormData;a.append("email",t),a.append("code",n),a.append("password",s),fetch("api/auth/reset-password",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(a)}).then((e=>e.json())).then((t=>{t.status?(r("password"),e("password","green"),o("password","Password has been reset!","green"),window.location.href="/login"):(r("password"),e("password","red"),o("password","Cannot change password! Make sure your email, code, and password are correct!","red"))}))})),document.querySelector("#showPassword").addEventListener("change",(function(){let e=document.getElementById("showPassword"),t=document.getElementById("password");e.checked?t.setAttribute("type","text"):t.setAttribute("type","password")}))})();