(()=>{const t=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),e=t=>`${new Intl.DateTimeFormat("en-US",{month:"long"}).format(t)} ${t.getDate()}, ${t.getFullYear()}`,o=()=>{let t=function(){let t=window.location.search.split("?")[2];return console.log(t),t?t.split("=")[1]:null}();n(),r(t),i(t)};const n=()=>{document.querySelectorAll(".profileBox").forEach((t=>{t.style.display="none"}))};const r=t=>{n();let e=document.querySelector(`#${t}`);if(e){e.style.display="flex",l(t);document.querySelectorAll("#profileSwitchViewBtn").forEach((e=>{e.getAttribute("data-target").toLowerCase()==t.toLowerCase()?e.classList.add("highlighted-border"):e.classList.remove("highlighted-border")}))}else document.querySelector("#posts").style.display="flex"},i=o=>{switch(r(o),function(t){let e=document.querySelector(`#${t}`);e&&e.childNodes.forEach((t=>t.remove()))}(o),o){case"posts":!function(){const o=new URLSearchParams(window.location.search);let n=new FormData;n.append("uid",o.get("uid").split("?")[0]),fetch("api/profile/return-posts",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(n)}).then((t=>t.json())).then((o=>{console.log(o),o.status&&o.posts.forEach((n=>function(o,n){const{_id:r,title:i,message:l,username:p,postDate:m,uID:f,likes:h,likesCount:y,comments:g,commentsCount:w,images:v}=o;let S=document.createElement("div"),L=new Date(m);S.innerHTML=`<div id="post">\n\t\t<span class="line"></span>\n\t\t<div class="forumPost" href="/forum?id=${r}" id=${r}>\n\t\t<div class="inlineForumUser">\n\t\t\t<img class="forumPfp" src="../images/default-pfp.jpeg"></img>\n\t\t\t<a class="forumUser" href="/profile?uid=${f}">${t(p)}</a>\n\t\t\t<p id="forumDate" class="forumUser"><i class="fa-solid fa-circle"></i> ${e(L)}</p>\n\t\t</div>\n\t\t<div class="forumTitle">\n\t\t\t<h3><a id="title" href="/forum?id=${r}">${t(i)}</a></h3>\n\t\t</div>\n\t\t\n\t\t\n\t\t<p style="white-space:pre;pointer-events:none;">${l}</p>\n\t\t<div id="images" style="display: flex; flex-direction: row; justify-content: flex-start;pointer-events:none;"></div>\n\t\t<div class="forumBtns">\n\t\t\t<p id="likeCounter">${y}</p>\n\t\t\t<button id="likeBtn" class="iconBtn"><i class="fa-regular fa-heart"></i></button>\n\t\t\t<p id="commentCounter">${w}</p>\n\t\t\t<button id="commentIcon" class="iconBtn"><i class="fa-regular fa-comment"></i></button>\n\t\t\t<button id="reportBtn" class="iconBtn"><i class="fa-regular fa-flag"></i></button>\n\t\t</div>\n\t\t</div>\n\t\t</div>\n\t\t`,s(f,S),h.includes(n)&&(S.querySelector("#likeBtn").querySelector("i").outerHTML='<i class="fa-solid fa-heart"></i>');if(n==f){let t=document.createElement("button");t.id="deleteBtn",t.className="iconBtn",t.innerHTML='<i class="fa-regular fa-trash-can"></i>',t.addEventListener("click",a),S.querySelector(".forumBtns").appendChild(t)}v.length>0&&v.forEach((t=>{S.querySelector("#images").appendChild(returnIconDiv(t,100))}));S.querySelector("#commentIcon").addEventListener("click",d),S.querySelector("#likeBtn").addEventListener("click",c),S.querySelector("#reportBtn").addEventListener("click",u),document.querySelector("#posts").appendChild(S)}(n,o.currentUserID)))})).catch((t=>{console.log(t)}))}();break;case"comments":console.log("load comments"),function(){const o=new URLSearchParams(window.location.search);let n=new FormData;n.append("uid",o.get("uid").split("?")[0]),fetch("api/profile/return-comments",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(n)}).then((t=>t.json())).then((o=>{console.log(o),o.status&&o.comments.forEach((n=>function(o,n){const{_id:r,author:i,authorID:l,content:a,postDate:c,comments:d,likes:u,likesCount:p,commentsCount:m}=o;console.log("Replies:",d);let g=new Date(c),v=document.createElement("div");v.innerHTML=`\n\t\t\t<div>\n\t\t\t<span class="line"></span>\n\t\t\t<div style="padding: 10px; border-radius: 10px;" class="comment" id=${r}>\n\t\t\t\t<div class="inlineForumUser">\n\t\t\t\t<img id="postPfp" class="forumPfp" src="${pfp}"></img>\n\t\t\t\t<a class="forumUser" href="/profile?uid=${l}">${t(i)}</a>\n\t\t\t\t<p id="forumDate" class="forumUser"><i class="fa-solid fa-circle"></i> ${e(g)}</p>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<p style="font-family: 'roboto'; font-size: 19px; color: #333;">${t(a)}</p>\n\t\t\t\t<div class="forumBtns">\n\t\t\t\t\t<p style="color: #333;" id="likeCounter">${p}</p>\n\t\t\t\t\t<button id="likeBtn" class="iconBtn"><i class="fa-regular fa-heart"></i></button>\n\t\t\t\t\t<button id="reportBtn" class="iconBtn"><i class="fa-regular fa-flag"></i></button>\n\t\t\t\t\t<button id="replyBtn" class="iconBtn">Reply</button>\n\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>`,s(l,v),v.querySelector("#likeBtn").addEventListener("click",f),v.querySelector("#replyBtn").addEventListener("click",w),v.querySelector("#reportBtn").addEventListener("click",h),u.includes(n)&&(v.querySelector("#likeBtn").querySelector("i").outerHTML='<i class="fa-solid fa-heart"></i>');if(n==l){let t=document.createElement("button");t.id="deleteBtn",t.className="iconBtn",t.innerHTML='<i class="fa-regular fa-trash-can"></i>',t.addEventListener("click",y),v.querySelector(".forumBtns").appendChild(t)}if(document.querySelector("#comments").appendChild(v),window.location.hash){"commentSection"==window.location.hash.substring(1)&&goToCommentSection()}if(d.length>0){let t=document.createElement("div"),e=`Load ${m} replies`;1===d.length&&(e=`Load ${m} reply`),t.innerHTML=`<button style="text-indent: 0px; padding: 10px;"class="faqBtn" id="openReplyBtn">${e}</button>`,t.querySelector("#openReplyBtn").addEventListener("click",openReplies),v.querySelector(".comment").appendChild(t)}}(n,o.currentUserID)))})).catch((t=>{console.log(t)}))}();break;case"annotations":case"favorites":case"followers":break;default:i("posts")}},l=t=>{let e=new URLSearchParams(window.location.search).get("uid").split("?")[0],o=`${window.location.origin}${window.location.pathname}?uid=${e}?v=${t}`;history.pushState(null,"",o)};function a(){let t=event.target.closest(".forumPost").id;const e=new FormData;e.append("postID",t),fetch("api/forum/delete-post",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(e)}).then((t=>t.json())).then((t=>{console.log(t),t.status?(console.log("success"),location.reload()):(t.message,console.log("error!"))})).catch((t=>{console.log(t)}))}function s(t,e){let o=new FormData;o.append("userID",t),fetch("api/profile/getPfp",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(o)}).then((t=>t.json())).then((async t=>{t.status?e.querySelector(".forumPfp").src="/image/"+t.pfp:e.querySelector(".forumPfp").src="../images/default-pfp.jpeg"}))}function c(){let t=event.target;"I"!=t.nodeName&&(t=t.querySelector("i"));const e=t.closest("#post"),o=e.querySelector("#likeBtn"),n=(e.querySelector("#title"),t.closest(".forumPost").id),r=e.querySelector("#likeCounter"),i=new FormData;i.append("postID",n);try{'<i class="fa-regular fa-heart"></i>'==t.outerHTML?(t.outerHTML='<i class="fa-solid fa-heart"></i>',r.innerHTML++):(t.outerHTML='<i class="fa-regular fa-heart"></i>',r.innerHTML--),o.enabled=!1}catch(t){console.log(t)}fetch("api/forum/likePost",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(i)}).then((t=>t.json())).then((e=>{console.log(e),"like"==e.type?t.outerHTML='<i class="fa-solid fa-heart"></i>':"unlike"==e.type&&(t.outerHTML='<i class="fa-regular fa-heart"></i>'),r.innerHTML=e.likes,o.enabled=!0})).catch((t=>{console.log(t),o.enabled=!0}))}function d(){let e=event.target.closest(".forumPost").id;location.href=`forum?id=${t(e)}#commentSection`}function u(){const t=event.target.closest(".forumPost"),e=t.id,o=t.querySelector(".forumUser").innerHTML;document.querySelector("#reportTitle").innerHTML=`Report <a href="/forum?id=${e}">${o}'s Post</a>`,document.querySelector("#makeReport").style.display="flex",document.querySelector("#reportInformation").style.display="flex"}function p(){let t=event.target.getAttribute("data-target").toLowerCase();i(t)}function m(){let t=event.target,e=t.closest("div").querySelector("#replyInput").value,o=t.closest(".comment").id,n=document.querySelector(".forumPost").id;const r=new FormData;r.append("content",e),r.append("commentID",o),r.append("postID",n),fetch("api/forum/reply",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(r)}).then((t=>t.json())).then((t=>{console.log(t),location.reload()})).catch((t=>{console.log(t)}))}function f(){let t=event.target;"I"!=t.nodeName&&(t=t.querySelector("i"));const e=t.closest(".comment"),o=e.querySelector("#likeBtn"),n=t.closest(".comment").id,r=e.querySelector("#likeCounter"),i=new FormData;i.append("commentID",n);try{'<i class="fa-regular fa-heart"></i>'==t.outerHTML?(t.outerHTML='<i class="fa-solid fa-heart"></i>',r.innerHTML++):(t.outerHTML='<i class="fa-regular fa-heart"></i>',r.innerHTML--),o.enabled=!1}catch(t){console.log(t)}fetch("api/forum/likeComment",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(i)}).then((t=>t.json())).then((e=>{console.log(e),"like"==e.type?t.outerHTML='<i class="fa-solid fa-heart"></i>':"unlike"==e.type&&(t.outerHTML='<i class="fa-regular fa-heart"></i>'),r.innerHTML=e.likes,o.enabled=!0})).catch((t=>{console.log(t),o.enabled=!0}))}function h(){const t=event.target.closest(".comment").id,e=post.querySelector(".forumUser").innerHTML;document.querySelector("#reportTitle").innerHTML=`Report <a href="/forum?id=${t}">${e}'s Comment</a>`,document.querySelector("#reportTitle").name=t,document.querySelector("#makeReport").style.display="flex",document.querySelector("#reportInformation").style.display="flex"}function y(){let t=event.target.closest(".comment").id;const e=new FormData;e.append("commentID",t),fetch("api/forum/delete-comment",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(e)}).then((t=>t.json())).then((t=>{console.log(t),t.status?(console.log("success"),window.location.reload()):(t.message,console.log("error!"))})).catch((t=>{console.log(t)}))}function g(){console.log("close");let t=event.target;t.closest(".comment").querySelectorAll("#replyDiv").forEach((t=>t.remove())),t.innerHTML="Reply",t.removeEventListener("click",g),t.addEventListener("click",w)}function w(){let t=event.target;t.innerHTML="Close";let e=t.closest(".comment");e.querySelectorAll("#replyDiv").forEach((t=>t.remove()));e.id;let o=document.createElement("div");o.id="replyDiv",o.innerHTML='<input id="replyInput" placeholder="Add your reply..."class="postText" type="text"><button style="margin-left: auto;margin-right:5%;text-indent: 0px; padding: 10px;" class="faqBtn" id="replySubmitBtn">Reply</button>',o.querySelector("#replySubmitBtn").addEventListener("click",m),e.querySelector(".forumBtns").insertAdjacentElement("afterend",o),t.removeEventListener("click",w),t.addEventListener("click",g)}!function(){const t=function(){let t=window.location.search.split("?")[1];return t?t.split("&")[0].split("=")[1]:null}();console.log(t);const e=new FormData;e.append("uid",t),fetch("api/profile/load",{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(e)}).then((t=>t.json())).then((t=>{console.log(t),t.status&&function(t){console.log(t),document.title=`${t.username} | Long X Ranch Cowboys`;let e=document.createElement("div");e.innerHTML=`<div class="profile" id="profile">\n\t\t<div class="profileInformation"> \n\t\t\t<div style="display: flex; flex-direction: column; color: #333; margin-bottom: 20px; width: 40%;">\n\t\t\t\t<img style="order: 1; width: 10vw; height: 10vw; border-radius: 50%; object-fit: cover; object-position: center; margin-inline: auto;" id="pfp" src="/image/${t.pfp}">\n\t\t\t\t<h1 class="profileUsername" style="order: 2; line-height: 15px; margin-left: 10px; font-size: 2.4vw; text-align: center;">${t.username}</h1>\n\t\t\t\t<h1 class="profileLocation" style="order: 3; line-height: 15px; margin-left: 10px; font-size: 1.7vw; text-align: center;">${t.city}, ${t.state}</h1>\n\t\t\t</div>\n\t\t\t<div style="width: 40%;">\n\t\t\t\t<h1 class="biographyHeader" style="margin-top: 0px; color: #333;">Biography</h1>\n\t\t\t\t<p class="profileBiography">${t.bio}</p>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="buttonRack">\n\t\t\t<button data-target="posts" class="highlighted-border" id="profileSwitchViewBtn">Posts</button>\n\t\t\t<button data-target="comments" id="profileSwitchViewBtn">Comments</button>\n\t\t\t<button data-target="annotations" id="profileSwitchViewBtn">Annotations</button>\n\t\t\t<button data-target="favorites" id="profileSwitchViewBtn">Favorites</button>\n\t\t\t<button data-target="followers" id="profileSwitchViewBtn">Followers</button>\n\t\t</div>\n\t\t<div style="width: 80%; margin-inline: auto;" id="posts" class="profileBox"></div>\n\t\t<div style="width: 80%; margin-inline: auto;" id="comments" class="profileBox"></div>\n\t\t<div style="width: 80%; margin-inline: auto;" id="annotations" class="profileBox"></div>\n\t\t<div style="width: 80%; margin-inline: auto;" id="favorites" class="profileBox"></div>\n\t\t<div style="width: 80%; margin-inline: auto;" id="followers" class="profileBox"></div>\n\t\t</div>\n\t\t`,e.querySelectorAll("#profileSwitchViewBtn").forEach((t=>{t.addEventListener("click",p)})),document.body.appendChild(e),o()}(t.profile)}))}(),document.addEventListener("DOMContentLoaded",(()=>{document.addEventListener("click",(t=>{t.target.matches(".forumPost")&&(location.href=`forum?id=${t.target.id}`)}))}))})();